# Mega Market Open API
Вступительное задание в Летнюю Школу Бэкенд Разработки Яндекса 2022

---
## Стек технологий  
- Docker
- Python 3.9
- FastAPI
- gunicorn
- Tarantool
- PyDantic
---

## Запуск
Для запуска сервера был подготовлен скрипт `scripts.sh`
Он имеет несколько команд: `build`, `docker_service`, `run`, `stop`, `rebuild`

- `build` - Скрипт для сборки Docker контейнеров
- `docker_service` - Добавление Docker в автозагрузку системы (для дальнейшего использования при перезапуске)
- `run` - Запуск контейнеров
- `stop` - Остановка контейнеров
- `rebuild` - Сборка и перезапуск контейнеров

Для того чтобы запустить сервер, необходимо выполнить следующие команды в директории проекта:
```bash
./scripts.sh docker_service
./scripts.sh rebuild
```

---

## Описание решения

Было выполнено 4 задачи из 5.  

Базовые:
- [x] /imports
- [x] /delete/{id}
- [x] /nodes/{id}

Дополнительные:
- [x] /sales
- [ ] /node/{id}/statistic

При получении запроса, Python сервер выполняет валидацию типов полей. 
В случае успеха, отправляет запрос в базу, где выполняется нужная функция, в зависимости от типа запроса.  
Весь основной код находится в базе Tarantool и написан на Lua, что позволяет повысить скорость поиска и вычислений.  
После обработки запроса, база возвращает JSON ответ, либо вызывает ошибку, если, например, произошла ошибка связанная с валидацией значений.  
JSON ответ, полученный в ходе успешного выполнения, отправляется как ответ.

---

## Структура проекта

В основной директории проекта расположены папки с содержимым сервера.  
- `api` - всё, что связано с Python сервером. Валидаторы, схемы, и сам код в файле `main.py`, в этом файле, так же расположены роутеры.
- `tarantool_db` - всё, что связано с базой на Tarantool. Код конфигурации, создания полей и функций, очередь. А также файл с классом Python для создания подключения.
- `task_details` - сведения о задании

---